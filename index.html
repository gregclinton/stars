<!--
    https://gregclinton.github.io/stars/
-->

<div>
    <div id="name"></div>
    <div id="ra"></div>
    <div id="dec"></div>
    <div id="decNorth"></div>
    <div id="decSouth"></div>
    <div onclick="explore('η Oph', '17:10:23', '-15 43')">η Oph, 17:10:23</div>
</div>

</body>

<link href="main.css" rel="stylesheet"/>
<script src="julian.js"></script>
<script src="longitude.js"></script>
<script src="sidereal.js"></script>
<script src="precess.js"></script>

<script>
    function put(name, value) {
        document.getElementById(name).innerHTML = value;
    }

    function parseRa(s) {
        parts = s.split(':');
        return 15 * (1 * parts[0] + parts[1] / 60 + parts[2] / 3600);
    }

    function parseDec(s) {
        parts = s.split(' ');
        return 1 * parts[0] + parts[1] / 60;
    }

    function formatRa(degrees) {
        return Math.floor(degrees / 15);
    }

    function formatDec(degrees) {
        return degrees / 15;
    }

    function explore(name, ra, dec) {
        enableDevice();
        const [raPrecessed, decPrecessed] = precess(parseRa(ra), parseDec(dec));

        put('name', name);
        put('ra', formatRa(raPrecessed));
        put('dec', formatDec(decPrecessed));
        put('decNorth', formatDec(declinationNorth));
    }

    const interval = setInterval(() => {
        if (deviceEnabled) {
            window.addEventListener('deviceorientation', e => {
                const incline = e.beta + (Math.abs(e.beta) < 5 ? 90 : 0);

                put('decSouth', formatDec(incline - (90 - latitude)));
                put('decNorth', formatDec(incline - latitude));
            });

            clearInterval(interval);
        }
    }, 1000);
</script>